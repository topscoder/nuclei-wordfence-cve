id: CVE-2021-24450

info:
  name: "ProfilePress <= 3.1.7 - Authenticated Stored Cross-Site Scripting"
  author: topscoder
  severity: Medium
  description: "The User Registration, User Profiles, Login & Membership â€“ ProfilePress (Formerly WP User Avatar) WordPress plugin before 3.1.8 did not sanitise or escape some of its settings before saving them and outputting them back in the page, allowing high privilege users such as admin to set JavaScript payloads in them even when the unfiltered_html capability is disallowed, leading to an authenticated Stored Cross-Site Scripting issue"
  reference:
    - https://wpscan.com/vulnerability/a8625579-fe8f-4bc1-a641-0e26ad141c92
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:N
    cvss-score: 5.5
    cve-id: CVE-2021-24450
  metadata:
    fofa-query: "wp-content/plugins/wp-user-avatar/"
    google-query: inurl:"/wp-content/plugins/wp-user-avatar/"
  tags: cve,wordpress,wp-plugin

requests:
  - method: GET
    path:
      - "{{BaseURL}}/wp-content/plugins/wp-user-avatar/readme.txt"

    extractors:
      - type: regex
        name: version
        internal: true
        group: 1
        regex:
          - "(?m)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "wp-user-avatar"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '< 3.1.8')