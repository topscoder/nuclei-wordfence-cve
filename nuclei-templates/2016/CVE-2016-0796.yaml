id: CVE-2016-0796

info:
  name: >
    mb.miniAudioPlayer <= 1.7.6 - Multiple Vulnerabilities
  author: topscoder
  severity: high
  description: >
    WordPress Plugin mb.miniAudioPlayer-an HTML5 audio player for your mp3 files is prone to multiple vulnerabilities, including open proxy and security bypass vulnerabilities because it fails to properly verify user-supplied input. An attacker may leverage these issues to hide attacks directed at a target site from behind vulnerable website or to perform otherwise restricted actions and subsequently download files with the extension mp3, mp4a, wav and ogg from anywhere the web server application has read access to the system. WordPress Plugin mb.miniAudioPlayer-an HTML5 audio player for your mp3 files version 1.7.6 is vulnerable; prior versions may also be affected.
  reference:
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/381708ae-3180-4058-a6f4-e925bfc658ec?source=api-prod
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:L
    cvss-score: 7.2
    cve-id: CVE-2016-0796
  metadata:
    fofa-query: "wp-content/plugins/wp-miniaudioplayer/"
    google-query: inurl:"/wp-content/plugins/wp-miniaudioplayer/"
    shodan-query: 'vuln:CVE-2016-0796'
  tags: cve,wordpress,wp-plugin,wp-miniaudioplayer,high

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/wp-miniaudioplayer/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "wp-miniaudioplayer"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 1.7.6')