id: CVE-2025-12770-new_user_approve-3f1cf77a-64b4-405b-adcb-ef16d9e82ab2

info:
  name: >
    New User Approve <= 3.0.9 - Unauthenticated Sensitive Information Disclosure via Type Juggling
  author: topscoder
  severity: medium
  description: >
    The New User Approve plugin for WordPress is vulnerable to unauthorized data disclosure in all versions up to, and including, 3.0.9 due to insufficient API key validation using loose equality comparison. This makes it possible for unauthenticated attackers to retrieve personally identifiable information (PII), including usernames and email addresses of users with various approval statuses via the Zapier REST API endpoints, by exploiting PHP type juggling with the api_key parameter set to "0" on sites where the Zapier API key has not been configured.
  reference:
    - https://github.com/topscoder/nuclei-wordfence-cve
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/3f1cf77a-64b4-405b-adcb-ef16d9e82ab2?source=api-prod
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cve-id: CVE-2025-12770
  metadata:
    fofa-query: "wp-content/plugins/new-user-approve/"
    google-query: inurl:"/wp-content/plugins/new-user-approve/"
    shodan-query: 'http.html:"wp-content/plugins/new-user-approve/"'
  tags: cve,wordpress,wp-plugin,new-user-approve,medium,production

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/new-user-approve/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag:\\s*([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "new-user-approve"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 3.0.9')