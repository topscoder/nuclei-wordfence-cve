id: CVE-2025-15403-custom_registration_form_builder_with_submission_manager-68dd9f6f-ccee-4a27-bd21-2fb32b92cc62

info:
  name: >
    RegistrationMagic <= 6.0.7.1 - Privilege Escalation via admin_order
  author: topscoder
  severity: critical
  description: >
    The RegistrationMagic plugin for WordPress is vulnerable to Privilege Escalation in all versions up to, and including, 6.0.7.1. This is due to the 'add_menu' function is accessible via the 'rm_user_exists' AJAX action and allows arbitrary updates to the 'admin_order' setting. This makes it possible for unauthenticated attackers to injecting an empty slug into the order parameter, and manipulate the plugin's menu generation logic, and when the admin menu is subsequently built, the plugin adds 'manage_options' capability for the target role. Note: The vulnerability can only be exploited unauthenticated, but further privilege escalation requires at least a subscriber user.
  reference:
    - https://github.com/topscoder/nuclei-wordfence-cve
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/68dd9f6f-ccee-4a27-bd21-2fb32b92cc62?source=api-prod
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2025-15403
  metadata:
    fofa-query: "wp-content/plugins/custom-registration-form-builder-with-submission-manager/"
    google-query: inurl:"/wp-content/plugins/custom-registration-form-builder-with-submission-manager/"
    shodan-query: 'http.html:"wp-content/plugins/custom-registration-form-builder-with-submission-manager/"'
  tags: cve,wordpress,wp-plugin,custom-registration-form-builder-with-submission-manager,critical,production

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/custom-registration-form-builder-with-submission-manager/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag:\\s*([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "custom-registration-form-builder-with-submission-manager"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 6.0.7.1')