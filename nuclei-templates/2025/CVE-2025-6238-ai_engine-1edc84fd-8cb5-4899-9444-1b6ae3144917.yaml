id: CVE-2025-6238-ai_engine-1edc84fd-8cb5-4899-9444-1b6ae3144917

info:
  name: >
    AI Engine 2.8.4 - Insecure OAuth Implementation
  author: topscoder
  severity: high
  description: >
    The AI Engine plugin for WordPress is vulnerable to open redirect in version 2.8.4. This is due to an insecure OAuth implementation, as the 'redirect_uri' parameter is missing validation during the authorization flow. This makes it possible for unauthenticated attackers to intercept the authorization code and obtain an access token by redirecting the user to an attacker-controlled URI. Note: OAuth is disabled, the 'Meow_MWAI_Labs_OAuth' class is not loaded in the plugin in the patched version 2.8.5.
  reference:
    - https://github.com/topscoder/nuclei-wordfence-cve
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/1edc84fd-8cb5-4899-9444-1b6ae3144917?source=api-prod
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H
    cvss-score: 8
    cve-id: CVE-2025-6238
  metadata:
    fofa-query: "wp-content/plugins/ai-engine/"
    google-query: inurl:"/wp-content/plugins/ai-engine/"
    shodan-query: 'http.html:"wp-content/plugins/ai-engine/"'
  tags: cve,wordpress,wp-plugin,ai-engine,high,production

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/ai-engine/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "ai-engine"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '2.8.4')