id: CVE-2019-16931-visualizer-eaaf1ac0-1ea6-4bcb-a385-87267525801c

info:
  name: >
    Visualizer: Tables and Charts Manager for WordPress <= 3.3.0 - Stored Cross-Site Scripting
  author: topscoder
  severity: high
  description: >
    A stored XSS vulnerability in the Visualizer plugin 3.3.0 for WordPress allows an unauthenticated attacker to execute arbitrary JavaScript when an admin or other privileged user edits the chart via the admin dashboard. This occurs because classes/Visualizer/Gutenberg/Block.php registers wp-json/visualizer/v1/update-chart with no access control, and classes/Visualizer/Render/Page/Data.php lacks output sanitization.
  reference:
    - https://github.com/topscoder/nuclei-wordfence-cve
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/eaaf1ac0-1ea6-4bcb-a385-87267525801c?source=api-prod
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2019-16931
  metadata:
    fofa-query: "wp-content/plugins/visualizer/"
    google-query: inurl:"/wp-content/plugins/visualizer/"
    shodan-query: 'http.html:"wp-content/plugins/visualizer/"'
  tags: cve,wordpress,wp-plugin,visualizer,high,production

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/visualizer/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "visualizer"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 3.3.0')