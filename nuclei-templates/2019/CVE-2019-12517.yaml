id: CVE-2019-12517

info:
  name: >
    SlickQuiz <= 1.3.7.1 - Stored Cross-Site Scripting
  author: topscoder
  severity: medium
  description: >
    An XSS issue was discovered in the slickquiz plugin through 1.3.7.1 for WordPress. The save_quiz_score functionality available via the /wp-admin/admin-ajax.php endpoint allows unauthenticated users to submit quiz solutions/answers, which are stored in the database and later shown in the WordPress backend for all users with at least Subscriber rights. Because the plugin does not properly validate and sanitize this data, a malicious payload in either the name or email field is executed directly within the backend at /wp-admin/admin.php?page=slickquiz across all users with the privileges of at least Subscriber.
  reference:
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/57e724ac-8e7d-45ec-9f41-4303ea6c5d30?source=api-prod
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2019-12517
  metadata:
    fofa-query: "wp-content/plugins/slickquiz/"
    google-query: inurl:"/wp-content/plugins/slickquiz/"
    shodan-query: 'vuln:CVE-2019-12517'
  tags: cve,wordpress,wp-plugin,slickquiz,medium

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/slickquiz/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "slickquiz"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 1.3.7.1')