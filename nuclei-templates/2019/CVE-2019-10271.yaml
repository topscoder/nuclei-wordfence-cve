id: CVE-2019-10271

info:
  name: >
    Ultimate Member <= 2.0.39 - Unauthorized Profile Modification
  author: topscoder
  severity: medium
  description: >
    An issue was discovered in the Ultimate Member plugin 2.0.39 for WordPress. It allows unauthorized profile and cover picture modification. It is possible to modify the profile and cover picture of any user once one is connected. One can also modify the profiles and cover pictures of privileged users. To perform such a modification, one first needs to (for example) intercept an upload-picture request and modify the user_id parameter.
  reference:
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/00b4b903-4682-458b-9681-751179460b75?source=api-prod
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N
    cvss-score: 4.3
    cve-id: CVE-2019-10271
  metadata:
    fofa-query: "wp-content/plugins/ultimate-member/"
    google-query: inurl:"/wp-content/plugins/ultimate-member/"
    shodan-query: 'vuln:CVE-2019-10271'
  tags: cve,wordpress,wp-plugin,ultimate-member,medium

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/ultimate-member/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "ultimate-member"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 2.0.40')