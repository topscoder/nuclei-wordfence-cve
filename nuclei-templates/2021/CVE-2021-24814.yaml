id: CVE-2021-24814

info:
  name: >
    WordPress GDPR & CCPA < 1.9.26 - Reflected Cross-Site Scripting
  author: topscoder
  severity: medium
  description: >
    The check_privacy_settings AJAX action of the WordPress GDPR WordPress plugin before 1.9.26, available to both unauthenticated and authenticated users, responds with JSON data without an "application/json" content-type. Since an HTML payload isn't properly escaped, it may be interpreted by a web browser led to this endpoint. Javascript code may be executed on a victim's browser. If the victim is an administrator with a valid session cookie, full control of the WordPress instance may be taken (AJAX calls and iframe manipulation are possible because the vulnerable endpoint is on the same domain as the admin panel - there is no same-origin restriction).
  reference:
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/fe023bc0-11b9-4520-874a-4656f633d4ac?source=api-prod
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2021-24814
  metadata:
    fofa-query: "wp-content/plugins/wordpress-gdpr/"
    google-query: inurl:"/wp-content/plugins/wordpress-gdpr/"
    shodan-query: 'vuln:CVE-2021-24814'
  tags: cve,wordpress,wp-plugin,wordpress-gdpr,medium

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/wordpress-gdpr/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "wordpress-gdpr"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 1.9.26')