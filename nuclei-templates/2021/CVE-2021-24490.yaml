id: CVE-2021-24490

info:
  name: >
    Email Artillery (MASS EMAIL) <= 4.1 - Arbitrary File Upload
  author: topscoder
  severity: high
  description: >
    The Email Artillery (MASS EMAIL) WordPress plugin through 4.1 does not properly check the uploaded files from the Import Emails feature, allowing arbitrary files to be uploaded. Furthermore, the plugin is also lacking any CSRF check, allowing such issue to be exploited via a CSRF attack as well. However, due to the presence of a .htaccess, denying access to everything in the folder the file is uploaded to, the malicious uploaded file will only be accessible on Web Servers such as Nginx/IIS
  reference:
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/1cbb309c-015b-4bdb-917a-a67e028484e6?source=api-prod
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 7.2
    cve-id: CVE-2021-24490
  metadata:
    fofa-query: "wp-content/plugins/email-artillery/"
    google-query: inurl:"/wp-content/plugins/email-artillery/"
    shodan-query: 'vuln:CVE-2021-24490'
  tags: cve,wordpress,wp-plugin,email-artillery,high

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/email-artillery/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "email-artillery"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 4.1')