id: CVE-2021-24503

info:
  name: >
    Popular Brand Icons - Simple Icons <= 2.7.7 - Authenticated Cross-Site Scripting
  author: topscoder
  severity: medium
  description: >
    The Popular Brand Icons â€“ Simple Icons WordPress plugin before 2.7.8 does not sanitise or validate some of its shortcode parameters, such as "color", "size" or "class", allowing users with a role as low as Contributor to set Cross-Site payload in them. A post made by a contributor would still have to be approved by an admin to have the XSS triggered in the frontend, however, higher privilege users, such as editor could exploit this without the need of approval, and even when the blog disallows the unfiltered_html capability.
  reference:
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/a9b074ed-2edd-4774-b0b2-dc08c9647094?source=api-prod
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 5.4
    cve-id: CVE-2021-24503
  metadata:
    fofa-query: "wp-content/plugins/simple-icons/"
    google-query: inurl:"/wp-content/plugins/simple-icons/"
    shodan-query: 'vuln:CVE-2021-24503'
  tags: cve,wordpress,wp-plugin,simple-icons,medium

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/simple-icons/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "simple-icons"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 2.7.8')