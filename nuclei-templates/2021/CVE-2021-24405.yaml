id: CVE-2021-24405

info:
  name: >
    Easy Cookies Policy <= 1.6.2 - Authenticated (Subscriber+) Stored Cross-Site Scripting
  author: topscoder
  severity: medium
  description: >
    The Easy Cookies Policy WordPress plugin through 1.6.2 is lacking any capability and CSRF check when saving its settings, allowing any authenticated users (such as subscriber) to change them. If users can't register, this can be done through CSRF. Furthermore, the cookie banner setting is not sanitised or validated before being output in all pages of the frontend and the backend settings one, leading to a Stored Cross-Site Scripting issue.
  reference:
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/f8f7a00e-9cb4-4640-bda9-0cd7341d0c41?source=api-prod
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N
    cvss-score: 6.4
    cve-id: CVE-2021-24405
  metadata:
    fofa-query: "wp-content/plugins/easy-cookies-policy/"
    google-query: inurl:"/wp-content/plugins/easy-cookies-policy/"
    shodan-query: 'vuln:CVE-2021-24405'
  tags: cve,wordpress,wp-plugin,easy-cookies-policy,medium

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/easy-cookies-policy/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "easy-cookies-policy"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 1.6.2')