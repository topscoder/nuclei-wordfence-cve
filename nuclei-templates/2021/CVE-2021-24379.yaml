id: CVE-2021-24379

info:
  name: >
    Comments Like Dislike <= 1.1.2 - Add Like/Dislike Bypass
  author: topscoder
  severity: medium
  description: >
    The Comments Like Dislike WordPress plugin before 1.1.4 allows users to like/dislike posted comments, however does not prevent them from replaying the AJAX request to add a like. This allows any user (even unauthenticated) to add unlimited like/dislike to any comment. The plugin appears to have some Restriction modes, such as Cookie Restriction, IP Restrictions, Logged In User Restriction, however, they do not prevent such attack as they only check client side
  reference:
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/f71e60b9-68e9-408a-8047-7f74b7fb72b2?source=api-prod
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
    cvss-score: 5.3
    cve-id: CVE-2021-24379
  metadata:
    fofa-query: "wp-content/plugins/comments-like-dislike/"
    google-query: inurl:"/wp-content/plugins/comments-like-dislike/"
    shodan-query: 'vuln:CVE-2021-24379'
  tags: cve,wordpress,wp-plugin,comments-like-dislike,medium

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/comments-like-dislike/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "comments-like-dislike"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 1.1.4')