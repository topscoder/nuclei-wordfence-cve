id: CVE-2021-24349

info:
  name: >
    Gallery from files <= 1.60 - Reflected Cross-Site Scripting
  author: topscoder
  severity: medium
  description: >
    This Gallery from files WordPress plugin through 1.6.0 gives the functionality of uploading images to the server. But filenames are not properly sanitized before being output in an error message when they have an invalid extension, leading to a reflected Cross-Site Scripting issue. Due to the lack of CSRF check, the attack could also be performed via such vector.
  reference:
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/d76b08c3-0d28-4e81-8843-5afded9efaa6?source=api-prod
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2021-24349
  metadata:
    fofa-query: "wp-content/plugins/gallery-from-files/"
    google-query: inurl:"/wp-content/plugins/gallery-from-files/"
    shodan-query: 'vuln:CVE-2021-24349'
  tags: cve,wordpress,wp-plugin,gallery-from-files,medium

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/gallery-from-files/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "gallery-from-files"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 1.60')