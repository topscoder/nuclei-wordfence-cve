id: CVE-2021-24688

info:
  name: >
    Orange Form <= 1.0.1 - Cross-Site Request Forgery
  author: topscoder
  severity: high
  description: >
    The Orange Form WordPress plugin through 1.0.1 does not have any authorisation and CSRF checks in all of its AJAX calls, for example the or_delete_filed one which is available to both unauthenticated and authenticated users could allow attackers to delete arbitrary posts.The AJAX calls performing actions on posts also do not ensure that the post belong to them (or that they are allowed to perform such action on it)
  reference:
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/ab248283-e331-4159-9fe4-249243772c9b?source=api-prod
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cve-id: CVE-2021-24688
  metadata:
    fofa-query: "wp-content/plugins/orange-form/"
    google-query: inurl:"/wp-content/plugins/orange-form/"
    shodan-query: 'vuln:CVE-2021-24688'
  tags: cve,wordpress,wp-plugin,orange-form,high

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/orange-form/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "orange-form"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 1.0.1')