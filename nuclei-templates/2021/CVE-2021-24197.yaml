id: CVE-2021-24197

info:
  name: "wpDataTables (Premium) <= 3.4.1 - Improper Access Control leading to Table Permission Takeover"
  author: topscoder
  severity: high
  description: "The wpDataTables â€“ Tables & Table Charts premium WordPress plugin before 3.4.2 has Improper Access Control. A low privilege authenticated user that visits the page where the table is published can tamper the parameters to access the data of another user that are present in the same table by taking over the user permissions on the table through formdata[wdt_ID] parameter. By exploiting this issue an attacker is able to access and manage the data of all users in the same table. Please note that this only affects the premium version of the plugin which shares the same slug as the free version."
  reference:
    - https://wpdatatables.com/help/whats-new-changelog/
    - https://wpscan.com/vulnerability/a56c04a4-dda0-4a7f-a525-d0349a1fda2b
    - https://n4nj0.github.io/advisories/wordpress-plugin-wpdatatables-ii/
    - https://nvd.nist.gov/vuln/detail/CVE-2021-24197
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
    cvss-score: 8.1
    cve-id: CVE-2021-24197
  metadata:
    fofa-query: "wp-content/plugins/wpdatatables/"
    google-query: inurl:"/wp-content/plugins/wpdatatables/"
    shodan-query: 'vuln:CVE-2021-24197'
  tags: cve,wordpress,wp-plugin,wpdatatables,high

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/wpdatatables/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "wpdatatables"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '< 3.4.2')