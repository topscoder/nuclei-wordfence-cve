id: CVE-2021-39331

info:
  name: >
    YITH Easy Login & Register Popup for WooCommerce <= 1.8.0 - Authentication Bypass via Password Reset
  author: topscoder
  severity: critical
  description: >
    The YITH Easy Login & Register Popup for WooCommerce plugin for WordPress is vulnerable to authorization bypass via password reset in versions up to, and including, 1.8.0. This is due to the plugin failing to properly validate if a user is authorized to perform a password reset for the supplied user_login via the yith_welrp_form_action AJAX. This makes it possible for unauthenticated users to reset administrators password and then log in to a site using that account.
  reference:
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/e186123e-313f-4b0e-9579-135cfdfa4bc0?source=api-prod
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-39331
  metadata:
    fofa-query: "wp-content/plugins/yith-easy-login-register-popup-for-woocommerce/"
    google-query: inurl:"/wp-content/plugins/yith-easy-login-register-popup-for-woocommerce/"
    shodan-query: 'vuln:CVE-2021-39331'
  tags: cve,wordpress,wp-plugin,yith-easy-login-register-popup-for-woocommerce,critical

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/yith-easy-login-register-popup-for-woocommerce/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "yith-easy-login-register-popup-for-woocommerce"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 1.8.0')