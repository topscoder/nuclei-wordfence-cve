id: CVE-2021-24977

info:
  name: >
    Use Any Font <= 6.2.0 - Unauthenticated Arbitrary CSS Appending
  author: topscoder
  severity: medium
  description: >
    The Use Any Font | Custom Font Uploader WordPress plugin before 6.2.1 does not have any authorisation checks when assigning a font, allowing unauthenticated users to send arbitrary CSS which will then be processed by the frontend for all users. Due to the lack of sanitisation and escaping in the backend, it could also lead to Stored XSS issues
  reference:
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/cb6de4da-0d60-4332-be25-5521e430a4fa?source=api-prod
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2021-24977
  metadata:
    fofa-query: "wp-content/plugins/use-any-font/"
    google-query: inurl:"/wp-content/plugins/use-any-font/"
    shodan-query: 'vuln:CVE-2021-24977'
  tags: cve,wordpress,wp-plugin,use-any-font,medium

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/use-any-font/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "use-any-font"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 6.2.1')