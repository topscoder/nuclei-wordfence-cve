id: CVE-2021-24472-qt_kentharadio-93b5552e-bb24-4dfb-a779-8451f619ff50

info:
  name: >
    QT KenthaRadio < 2.0.2 & OnAir2 < 3.9.9.2 - Server-Side Request Forgery & Remote File Inclusion
  author: topscoder
  severity: critical
  description: >
    The OnAir2 WordPress theme before 3.9.9.2 and QT KenthaRadio WordPress plugin before 2.0.2 have exposed proxy functionality to unauthenticated users, sending requests to this proxy functionality will have the web server fetch and display the content from any URI, this would allow for SSRF (Server Side Request Forgery) and RFI (Remote File Inclusion) vulnerabilities on the website.
  reference:
    - https://github.com/topscoder/nuclei-wordfence-cve
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/93b5552e-bb24-4dfb-a779-8451f619ff50?source=api-prod
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-24472
  metadata:
    fofa-query: "wp-content/plugins/qt-kentharadio/"
    google-query: inurl:"/wp-content/plugins/qt-kentharadio/"
    shodan-query: 'http.html:"wp-content/plugins/qt-kentharadio/"'
  tags: cve,wordpress,wp-plugin,qt-kentharadio,critical,production

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/qt-kentharadio/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "qt-kentharadio"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '< 2.0.2')