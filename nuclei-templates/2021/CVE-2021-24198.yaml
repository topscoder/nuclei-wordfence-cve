id: CVE-2021-24198

info:
  name: "wpDataTables (Premium) <= 3.4.1 - Improper Access Control leading to Table Data Deletion"
  author: topscoder
  severity: high
  description: "The wpDataTables â€“ Tables & Table Charts premium WordPress plugin before 3.4.2 has Improper Access Control. A low privilege authenticated user that visits the page where the table is published can tamper the parameters to delete the data of another user that are present in the same table through id_key and id_val parameters. By exploiting this issue an attacker is able to delete the data of all users in the same table. Please note that this only affects the premium version of the plugin which shares the same slug as the free version."
  reference:
    - https://wpdatatables.com/help/whats-new-changelog/
    - https://n4nj0.github.io/advisories/wordpress-plugin-wpdatatables-ii/
    - https://wpscan.com/vulnerability/d953bc62-8a6f-445b-a556-bc25cdd200e3
    - https://nvd.nist.gov/vuln/detail/CVE-2021-24198
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:H
    cvss-score: 8.1
    cve-id: CVE-2021-24198
  metadata:
    fofa-query: "wp-content/plugins/wpdatatables/"
    google-query: inurl:"/wp-content/plugins/wpdatatables/"
    shodan-query: 'vuln:CVE-2021-24198'
  tags: cve,wordpress,wp-plugin,wpdatatables,high

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/wpdatatables/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "wpdatatables"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '< 3.4.2')