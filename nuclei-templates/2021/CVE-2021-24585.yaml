id: CVE-2021-24585

info:
  name: >
    Timetable and Event Schedule by MotoPress <= 2.3.19 - Arbitrary User's Hashed Password/Email/Username Disclosure
  author: topscoder
  severity: medium
  description: >
    The Timetable and Event Schedule WordPress plugin before 2.4.0 outputs the Hashed Password, Username and Email Address (along other less sensitive data) of the user related to the Even Head of the Timeslot in the response when requesting the event Timeslot data with a user with the edit_posts capability. Combined with the other Unauthorised Event Timeslot Modification issue (https://wpscan.com/reports/submissions/4699/) where an arbitrary user ID can be set, this could allow low privilege users with the edit_posts capability (such as author) to retrieve sensitive User data by iterating over the user_id
  reference:
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/b14af68e-960f-4817-bab4-881f2720cb82?source=api-prod
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 6.5
    cve-id: CVE-2021-24585
  metadata:
    fofa-query: "wp-content/plugins/mp-timetable/"
    google-query: inurl:"/wp-content/plugins/mp-timetable/"
    shodan-query: 'vuln:CVE-2021-24585'
  tags: cve,wordpress,wp-plugin,mp-timetable,medium

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/mp-timetable/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "mp-timetable"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 2.3.19')