id: CVE-2022-1020

info:
  name: "Product Table for WooCommerce <= 3.1.2 - Missing Authorization"
  author: topscoder
  severity: critical
  description: "The Product Table for WooCommerce (wooproducttable) WordPress plugin before 3.1.2 does not have authorisation and CSRF checks in the wpt_admin_update_notice_option AJAX action (available to both unauthenticated and authenticated users), as well as does not validate the callback parameter, allowing unauthenticated attackers to call arbitrary functions with either none or one user controlled argument"
  reference:
    - https://wpscan.com/vulnerability/04fe89b3-8ad1-482f-a96d-759d1d3a0dd5
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-1020
  metadata:
    fofa-query: "wp-content/plugins/woo-product-table/"
    google-query: inurl:"/wp-content/plugins/woo-product-table/"
    shodan-query: 'vuln:CVE-2022-1020'
  tags:  cve,wordpress,wp-plugin,critical

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/woo-product-table/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "woo-product-table"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '< 3.1.2')