id: CVE-2022-2594

info:
  name: >
    Beebee Mini <= 1.2.0 - Unauthorized File Upload via ACF
  author: topscoder
  severity: medium
  description: >
    The Beebee Mini plugin for WordPress uses Advanced Custom Fields which has a file upload vulnerability in versions up to, and including, 5.12.2. This makes it possible for users without the upload_files capability, such as contributors, or unauthenticated users in cases where a frontend form is added to the site, to upload allowed file types. The upload is handled by WordPress so file type and extension checks still occur, though this could potentially be used by high-privileged users in certain locked-down configurations to bypass other security mechanisms and upload dangerous file types. This affects versions up to 1.2.0 in the Beebee Mini plugin.
  reference:
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/27ca0d04-9796-415f-a6e6-7c1752a74fea?source=api-prod
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N
    cvss-score: 4.3
    cve-id: CVE-2022-2594
  metadata:
    fofa-query: "wp-content/plugins/beebee-mini/"
    google-query: inurl:"/wp-content/plugins/beebee-mini/"
    shodan-query: 'vuln:CVE-2022-2594'
  tags: cve,wordpress,wp-plugin,beebee-mini,medium

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/beebee-mini/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "beebee-mini"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 1.2.0')