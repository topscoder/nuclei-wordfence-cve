id: CVE-2022-0770

info:
  name: >
    Translate WordPress with GTranslate <= 2.9.8 & Translate WordPress – Google Language Translator <= 6.0.13 - Missing Authorization to Sensitive Information Disclosure
  author: topscoder
  severity: high
  description: >
    The Translate WordPress with GTranslate <= 2.9.8 &  Translate WordPress – Google Language Translator <= 6.0.13  WordPress plugins do not have proper capabilities checks in the /wp-content/plugins/gtranslate/url_addon/gtranslate.php file which writes debug data such as user's cookies in a publicly accessible file when the enable_debug parameter is set to true. This would make it possible for an attacker to steal and administrators cookies if they can successfully trick them into accessing that file with the parameter set.
  reference:
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/ff21e539-8ba0-4edd-a90c-27a4cd1cdbc7?source=api-prod
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cve-id: CVE-2022-0770
  metadata:
    fofa-query: "wp-content/plugins/gtranslate/"
    google-query: inurl:"/wp-content/plugins/gtranslate/"
    shodan-query: 'vuln:CVE-2022-0770'
  tags: cve,wordpress,wp-plugin,gtranslate,high

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/gtranslate/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "gtranslate"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 2.9.9')