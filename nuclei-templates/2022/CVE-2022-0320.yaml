id: CVE-2022-0320

info:
  name: >
    Essential Addons for Elementor  <= 5.0.4 - Local File Inclusion
  author: topscoder
  severity: critical
  description: >
    The Essential Addons for Elementor WordPress plugin before 5.0.5 does not validate and sanitise some template data before it them in include statements, which could allow unauthenticated attackers to perform Local File Inclusion attack and read arbitrary files on the server, this could also lead to RCE via user uploaded files or other LFI to RCE techniques.
  reference:
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/014f1aae-10a0-4bc8-b176-dbdad94a6ad8?source=api-prod
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-0320
  metadata:
    fofa-query: "wp-content/plugins/essential-addons-for-elementor-lite/"
    google-query: inurl:"/wp-content/plugins/essential-addons-for-elementor-lite/"
    shodan-query: 'vuln:CVE-2022-0320'
  tags: cve,wordpress,wp-plugin,essential-addons-for-elementor-lite,critical

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/essential-addons-for-elementor-lite/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "essential-addons-for-elementor-lite"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '>= 1.0.0', '<= 5.0.4')