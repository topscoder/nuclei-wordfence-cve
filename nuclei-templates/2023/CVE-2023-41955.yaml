id: CVE-2023-41955

info:
  name: >
    Essential Addons for Elementor <= 5.8.8 - Authenticated (Contributor+) Privilege Escalation
  author: topscoder
  severity: high
  description: >
    The Essential Addons for Elementor  plugin for WordPress is vulnerable to privilege escalation in versions up to and including 5.8.8 due to a lack of restrictions on who can add a registration form and a custom registration role to an Elementor created page. This makes it possible for attackers with access to the Elementor page builder to create a new registration form that defaults to the user role being set to administrator and subsequently register as an administrative user. Note that this is difficult to exploit without publishing capabilities and appears to be a regression, as an identical issue was patched in version 4.6.5.
  reference:
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/8c13701e-424d-462f-b152-4dc5ad3ef197?source=api-prod
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cve-id: CVE-2023-41955
  metadata:
    fofa-query: "wp-content/plugins/essential-addons-for-elementor-lite/"
    google-query: inurl:"/wp-content/plugins/essential-addons-for-elementor-lite/"
    shodan-query: 'vuln:CVE-2023-41955'
  tags: cve,wordpress,wp-plugin,essential-addons-for-elementor-lite,high

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/essential-addons-for-elementor-lite/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "essential-addons-for-elementor-lite"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 5.8.8')