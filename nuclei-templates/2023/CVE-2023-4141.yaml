id: CVE-2023-4141

info:
  name: >
    WP Ultimate CSV Importer <= 7.9.8 - Authenticated (Author+) PHP File Creation to Remote Code Execution
  author: topscoder
  severity: high
  description: >
    The WP Ultimate CSV Importer plugin for WordPress is vulnerable to Remote Code Execution in versions up to, and including, 7.9.8 via the '->cus2' parameter. This allows authenticated attackers with author-level permissions or above, if the administrator previously grants access in the plugin settings, to create a PHP file and execute code on the server. The author resolved this vulnerability by removing the ability for authors and editors to import files, please note that this means php file creation is still allowed for site administrators, use the plugin with caution.
  reference:
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/b4fe8b1f-da1c-4f94-9ab4-272766b488c3?source=api-prod
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 8
    cve-id: CVE-2023-4141
  metadata:
    fofa-query: "wp-content/plugins/wp-ultimate-csv-importer/"
    google-query: inurl:"/wp-content/plugins/wp-ultimate-csv-importer/"
    shodan-query: 'vuln:CVE-2023-4141'
  tags: cve,wordpress,wp-plugin,wp-ultimate-csv-importer,high

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/wp-ultimate-csv-importer/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "wp-ultimate-csv-importer"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 7.9.8')